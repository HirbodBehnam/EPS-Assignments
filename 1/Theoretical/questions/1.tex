\smalltitle{سوال 1}\\
در ابتدا دقت کنید که در صورتی که
$n \equiv 0 ~ \text{or} ~ 2\pmod{3}$
باشد هیچ جایگشتی جواب مسئله نیست چرا که در این حالات جمع اعداد بر 3 بخش پذیر می‌شوند.
جمع اعداد به ترتیب برابر با
$\frac{(3k + 1) \times 3k}{2}$
و
$\frac{3k \times (3k - 1)}{2}$
هستند پس در نهایت جمع تمامی اعداد بر 3 بخش پذیر‌اند.
حال حالت
$n \equiv 1\pmod{3}$
را بررسی می‌کنیم.
\\~
در ابتدا دقت کنید که اعداد‌های بخش پذیر بر 3 در هرجایی غیر از اولین عدد می‌توان قرار داد چرا که
آنها تاثیری بر روی باقی‌مانده‌ی مجموع بر 3 ندارند.
همچنین آنرا نمی‌توان به عنوان اولین عدد قرار داد چرا که در آن صورت
$S_1$
بر 3 بخش پذیر می‌شود.
در این مجموعه
$\lfloor \frac{n}{3} \rfloor + 1$
باقی‌مانده‌ی آنها بر 3 برابر 1 است و 
$\lfloor \frac{n}{3} \rfloor$
باقی‌مانده‌شان برابر 2 است.
فرض کنید که
$a_1 \equiv 2\pmod{3}$
است. در این صورت مشخصا باید
$a_2 \equiv 2\pmod{3}$
باشد که
$a_1 + a_2$
بر 3 بخش پذیر نشود.
سپس باید یکی در میان از اعداد با باقی‌مانده‌ی 1 و 2 بر سه استفاده کنیم.
(دقت کنید که اعداد با باقی‌مانده‌ی 0 را در نظر نگرفتیم چون همان طور که گفته شد آن‌ها در هر جایی می‌توانند
بیایند)
اما همان طور که گفته شد تعداد اعداد با باقی‌مانده‌ی 1 یکی بیشتر از اعداد با باقی‌مانده‌ی 2 هستند.
پس در نهایت این دنباله قبل از عدد آخر مجموع اعداد بر 3 بخش پذیر می‌شود.
پس دنباله‌ی ما با عددی شروع می‌شود که باقی‌مانده‌اش بر 3 برابر 1 است.
سپس باز هم یک عدد می‌آید که باقی‌مانده‌اش برابر یک است و سپس 2 می‌آید و دوباره 1 و همین طور تا آخر\dots
حال باید ببینیم که به چند روش می‌توان این دنباله را ساخت.
\\~
در کل
$n$
جایگاه عدد داریم. از این جایگاه‌ها
$\lfloor \frac{n}{3} \rfloor$
آن‌ها را برای اعداد بخش پذیر بر 3 انتخاب می‌کنیم (غیر از اولی) و به
$\lfloor \frac{n}{3} \rfloor!$
حالت آن‌ها را می‌چینیم.
حال بقیه‌ی اعداد را نیز به
$\lfloor \frac{n}{3} \rfloor!$
و
$\lfloor \frac{n}{3} + 1 \rfloor!$
حالت در جایگاه‌هایشان می‌چینیم. پس در کل احتمال خواسته شده برابر است با:
\begin{gather*}
    \frac{{n - 1 \choose \lfloor \frac{n}{3} \rfloor} \times \lfloor \frac{n}{3} \rfloor! \times \lfloor \frac{n}{3} \rfloor! \times \lfloor \frac{n}{3} + 1 \rfloor!}{n!}
\end{gather*}